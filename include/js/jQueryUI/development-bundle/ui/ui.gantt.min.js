(function(a){a.widget("ui.gantt",{_init:function(){this.element.addClass("ui-gantt ui-widget");this.table=a('<table class="ui-gantt-table" cellspacing=0></table>').appendTo(this.element);if(a.datepicker.regional[this.options.language]!=undefined){this.monthNames=a.datepicker.regional[this.options.language]["monthNames"];this.monthNamesShort=a.datepicker.regional[this.options.language]["monthNamesShort"]}else{this.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];this.monthNamesShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}a("<thead><tr></tr><tr></tr></thead><tfoot><tr></tr><tr></tr></tfoot>").appendTo(this.table);this.titles(this.options.titles);this._getTHeadAndTFootCalendar();a("<tbody></tbody>").appendTo(this.table);this._getTBody()},destroy:function(){this.element.removeClass("ui-gantt ui-widget").removeData("gantt");this.table.remove();a.widget.prototype.destroy.apply(this,arguments)},titles:function(c){if(c===undefined){return this._titles()}while(c.length<3){c.push("Title")}while(c.length>3){c.pop()}for(var b=1;b<=3;b++){if(this.table.children("thead").children("tr:first").children("th:nth-child("+b+")").html()==null){this.table.children("thead").children("tr:first").append('<th rowspan=2 class="ui-widget-header ui-gantt-header">'+c[b-1]+"</th>");this.table.children("tfoot").children("tr:first").append('<th rowspan=2 class="ui-widget-header ui-gantt-header">'+c[b-1]+"</th>")}else{this.table.children("thead").children("tr:first").children("th:nth-child("+b+")").replaceWith('<th rowspan=2 class="ui-widget-header ui-gantt-header">'+c[b-1]+"</th>");this.table.children("tfoot").children("tr:first").children("th:nth-child("+b+")").replaceWith('<th class="ui-widget-header ui-gantt-header">'+c[b-1]+"</th>")}}this.options.titles=c;return this},_setData:function(b,c){switch(b){case"titles":this.titles(c);this._trigger("change",null,{});break;case"tasks":this.options.tasks=c;this._trigger("change",null,{});break;case"displayStartDate":this.options.displayStartDate=c;this._trigger("change",null,{});break;case"displayFinishDate":this.options.displayFinishDate=c;this._trigger("change",null,{});break}a.widget.prototype._setData.apply(this,arguments)},_titles:function(){return this.options.titles},_tasks:function(){return this.options.tasks},_displayStartDate:function(){return this.options.displayStartDate},_displayFinishDate:function(){return this.options.displayFinishDate},_getTHeadAndTFootCalendar:function(){var b=this.options.displayStartDate.split("-");var h=parseInt(b[0],10);var p=parseInt(b[1],10)-1;var g=parseInt(b[2],10);var e=this.options.displayFinishDate.split("-");var l=parseInt(e[0],10);var m=parseInt(e[1],10)-1;var n=parseInt(e[2],10);var i=-1;var f=h;var d=g;var j=0;var r=this.options.titles.length+1;var q=g;while(this.table.children("thead").children("tr:first").children("th:nth-child("+r+")").html()!=null&&this.table.children("tfoot").children("tr:first").children("th:nth-child("+r+")").html()!=null){this.table.children("thead").children("tr:first").children("th:nth-child("+r+")").remove();this.table.children("tfoot").children("tr:first").children("th:nth-child("+r+")").remove()}this.table.children("thead").children("tr:nth-child(2)").html("");this.table.children("tfoot").children("tr:nth-child(2)").html("");while(new Date(h,p,g).getFullYear()!=new Date(l,m,n-(-1)).getFullYear()||new Date(h,p,g).getMonth()!=new Date(l,m,n-(-1)).getMonth()||new Date(h,p,g).getDate()!=new Date(l,m,n-(-1)).getDate()){if(i!=parseInt(new Date(h,p,g).getMonth(),10)){i=parseInt(new Date(h,p,g).getMonth(),10);f=parseInt(new Date(h,p,g).getFullYear(),10);var k=i+1;if(i==m&&f==l){j=n}else{j=parseInt(new Date(f,k,0).getDate(),10)}if(i!=p||f!=h){d=1;q=1}var c=j-d+1;if(c<5){var o=this.monthNamesShort[k-1]}else{var o=this.monthNames[k-1]}this.table.children("thead").children("tr:first").append("<th colspan="+c+' class="ui-widget-header ui-gantt-header">'+o+" "+f+"</th>");this.table.children("tfoot").children("tr:nth-child(2)").append("<th colspan="+c+' class="ui-widget-header ui-gantt-header">'+o+" "+f+"</th>")}if(q<10){q="0"+q}this.table.children("thead").children("tr:nth-child(2)").append('<th class="ui-widget-header ui-gantt-header">'+q+"</th>");this.table.children("tfoot").children("tr:first").append('<th class="ui-widget-header ui-gantt-header">'+q+"</th>");switch(parseInt(new Date(h,p,g).getDay(),10)){case 0:this.table.children("tfoot").children("tr:first").children("th:last").addClass("ui-gantt-sunday");this.table.children("thead").children("tr:nth-child(2)").children("th:last").addClass("ui-gantt-sunday");break;case 1:this.table.children("tfoot").children("tr:first").children("th:last").addClass("ui-gantt-monday");this.table.children("thead").children("tr:nth-child(2)").children("th:last").addClass("ui-gantt-monday");break;case 2:this.table.children("tfoot").children("tr:first").children("th:last").addClass("ui-gantt-tuesday");this.table.children("thead").children("tr:nth-child(2)").children("th:last").addClass("ui-gantt-tuesday");break;case 3:this.table.children("tfoot").children("tr:first").children("th:last").addClass("ui-gantt-wednesday");this.table.children("thead").children("tr:nth-child(2)").children("th:last").addClass("ui-gantt-wednesday");break;case 4:this.table.children("tfoot").children("tr:first").children("th:last").addClass("ui-gantt-thursday");this.table.children("thead").children("tr:nth-child(2)").children("th:last").addClass("ui-gantt-thursday");break;case 5:this.table.children("tfoot").children("tr:first").children("th:last").addClass("ui-gantt-friday");this.table.children("thead").children("tr:nth-child(2)").children("th:last").addClass("ui-gantt-friday");break;case 6:this.table.children("tfoot").children("tr:first").children("th:last").addClass("ui-gantt-saturday");this.table.children("thead").children("tr:nth-child(2)").children("th:last").addClass("ui-gantt-saturday");break}g=g+1;q=parseInt(q,10)+1}},_getTBody:function(){this.table.children("tbody").html("");for(var b=0;b<this.options.tasks.length;b++){this.addTask(this.options.tasks[b])}},addTask:function(c){this.table.children("tbody").append("<tr><td>"+c.id+"</td><td>"+c.task+"</td><td>"+c.progression+"</td></tr>");if(this._dayBetween(c.startDate,this.options.displayFinishDate)<0){var b=this.options.displayFinishDate}else{var b=c.startDate}var m=this._dayBetween(this.options.displayStartDate,b);if(this._dayBetween(this.options.displayStartDate,c.finishDate)<0){var l=this.options.displayStartDate}else{var l=c.finishDate}var e=this._dayBetween(l,this.options.displayFinishDate);if(m<0){var d=this.options.displayStartDate}else{var d=c.startDate}if(e<0){var f=this.options.displayFinishDate}else{var f=c.finishDate}var k=this._dayBetween(d,f)+1;var h=Math.round(c.progression/100*(this._dayBetween(c.startDate,c.finishDate)+1));var j=Math.min(Math.max(h+Math.min(m,0),0),k);for(var g=0;g<m;g++){this.table.children("tbody").children("tr:last").append('<td class="ui-gantt-day"></td>')}for(var g=0;g<j;g++){this.table.children("tbody").children("tr:last").append('<td class="ui-gantt-day"><div class="ui-gantt-task-barr ui-gantt-task-barr-complete"></div></td>')}for(var g=j;g<k;g++){this.table.children("tbody").children("tr:last").append('<td class="ui-gantt-day"><div class="ui-gantt-task-barr"></div></td>')}if(k<=0){this.table.children("tbody").children("tr:last").append('<td class="ui-gantt-day"></td>')}for(var g=0;g<e;g++){this.table.children("tbody").children("tr:last").append('<td class="ui-gantt-day"></td>')}for(var g=this.options.titles.length;g<this._dayBetween(this.options.displayStartDate,this.options.displayFinishDate)+this.options.titles.length;g++){if(this.table.children("tfoot").children("tr:first").children("th:nth-child("+g+")").is(".ui-gantt-sunday")){this.table.children("tbody").children("tr:last").children("td:nth-child("+g+")").addClass("ui-gantt-sunday")}if(this.table.children("tfoot").children("tr:first").children("th:nth-child("+g+")").is(".ui-gantt-monday")){this.table.children("tbody").children("tr:last").children("td:nth-child("+g+")").addClass("ui-gantt-monday")}if(this.table.children("tfoot").children("tr:first").children("th:nth-child("+g+")").is(".ui-gantt-tuesday")){this.table.children("tbody").children("tr:last").children("td:nth-child("+g+")").addClass("ui-gantt-tuesday")}if(this.table.children("tfoot").children("tr:first").children("th:nth-child("+g+")").is(".ui-gantt-wednesday")){this.table.children("tbody").children("tr:last").children("td:nth-child("+g+")").addClass("ui-gantt-wednesday")}if(this.table.children("tfoot").children("tr:first").children("th:nth-child("+g+")").is(".ui-gantt-thursday")){this.table.children("tbody").children("tr:last").children("td:nth-child("+g+")").addClass("ui-gantt-thursday")}if(this.table.children("tfoot").children("tr:first").children("th:nth-child("+g+")").is(".ui-gantt-friday")){this.table.children("tbody").children("tr:last").children("td:nth-child("+g+")").addClass("ui-gantt-friday")}if(this.table.children("tfoot").children("tr:first").children("th:nth-child("+g+")").is(".ui-gantt-saturday")){this.table.children("tbody").children("tr:last").children("td:nth-child("+g+")").addClass("ui-gantt-saturday")}}},_dayBetween:function(b,d){var b=b.split("-");var f=parseInt(b[0],10);var j=parseInt(b[1],10)-1;var e=parseInt(b[2],10);var d=d.split("-");var g=parseInt(d[0],10);var h=parseInt(d[1],10)-1;var i=parseInt(d[2],10);var c=new Date();c.setTime(new Date(g,h,i).getTime()-new Date(f,j,e).getTime());return c.getTime()/1000/3600/24},});a.extend(a.ui.gantt,{version:"1.7.2",defaults:{titles:["Id","Task","Compl.(%)","Start Date","Finish Date"],tasks:[],displayStartDate:null,displayFinishDate:null,language:"en"}})})(jQuery);